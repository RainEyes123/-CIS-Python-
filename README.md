# -CIS-Python


## 基于CIS标准的操作系统安全基线自动核查Python脚本实现




目录
前言
一 研究背景和当前存在的问题或应用场景

1.1 操作系统安全基线核查背景
1.2 当前存在的问题
1.2.1 脚本架构设计问题
1.2.2 系统查询效率问题
1.2.3 系统控制要求的变更问题

二 解决上述问题的思路

2.1 脚本架构设计问题
2.2 系统查询效率问题
2.3 系统控制要求的变更问题
三 设计作品架构描述
3.1 系统环境变量采集
3.2 参数提取
3.3 策略比对
3.4 报告输出

四 重点技术介绍

4.1 Python
4.2 CIS标准
4.3 SQLite3

五 设计作品详细设计架构和过程

5.1 CIS基线选取
5.2 数据库设计
5.2.1 modular2
5.2.2 rule2
5.3 Python脚本设计

六 测试分析，能否解决第一章的问题

6.1 脚本架构设计测试
6.2 系统查询效率测试
6.3 系统控制要求变更测试

结论

总结与体会

致谢

参考文献



## 前言
随着网络空间的日益发展，操作系统安全基线变得越来越重要，其目的是为了保护系统资源免受恶意攻击，确保系统的安全性和数据的完整性。因此，如何快速准确的核查操作系统的安全基线，成为了企业和组织的重大课题。

CIS标准（Center for Internet Security）是美国国际互联网安全中心研发的一套专业的操作系统安全基线标准，旨在保障系统的安全性和数据的完整性，以确保企业和组织在网络空间中安全运行。CIS标准中提供了大量的操作系统安全基线核查项，但传统的人工核查方式耗时较长，且不能确保核查结果的准确性。

为了解决上述问题，本文提出了一种基于CIS标准的操作系统安全基线自动核查Python脚本实现的方法。本文详细介绍了自动核查脚本实现方式，解释了Python脚本实现的具体技术，并介绍了脚本的架构和实现技术。最后，本文提出了实现此自动核查脚本的应用场景，并就此进行了分析。


## 研究背景和当前存在的问题或应用场景
1.1 操作系统安全基线核查背景
随着网络空间的迅猛发展，操作系统安全基线的重要性越来越突出。操作系统安全基线是指确保系统安全性和数据完整性的措施，可以包括系统配置、安全配置、安全审计、访问控制等方面的内容。CIS标准是一套专业的操作系统安全基线标准，旨在帮助企业和组织在网络空间中安全运行。CIS标准中提出了大量的操作系统安全基线核查项，以实现操作系统安全基线的有效核查和维护。

1.2 当前存在的问题
1.2.1 脚本架构设计问题
由于CIS标准具有较多的安全控制要求，脚本设计者需要考虑如何将每一项控制要求封装成一个简单易用的接口，以便脚本在查询控制要求时能够得到清晰的结果。
1.2.2 系统查询效率问题
CIS标准的控制要求涉及到操作系统的几乎所有方面，因此，脚本执行时需要查询较多的系统信息，如果查询效率不高，将导致脚本执行过程较慢，影响安全核查的效率。
1.2.3 系统控制要求的变更问题
由于系统变更是一个常见的情况，因此，脚本设计者需要考虑如何让脚本能够检测出系统变更，以确保脚本能够检测出变更后的系统状态，以便及时采取安全措施。


## 解决上述问题的思路
2.1 脚本架构设计问题
有些可以采用面向对象编程的思想，将每一项控制要求封装成一个类，以实现对每一项控制要求的封装和查询，也可使用面向过程函数。此外，可以使用模块化编程，将不同的控制要求模块化，以便于维护和更新，减少重复代码和模块间的耦合性。最后，可以使用设计模式，将这些模块按照单一职责原则，组织起来，使得脚本更加健壮可靠。
2.2 系统查询效率问题
可以采用多线程技术，将查询任务分解成多个子任务，分别由不同的线程执行，从而提高查询效率。另外，可以利用缓存技术，将数据库中频繁查询的数据缓存到内存中，以减少对数据库的访问，从而提高查询效率。
2.3 系统控制要求的变更问题
可以在脚本中实现对系统控制要求的定期检测，以便及时检测出系统变更，并及时采取安全措施。此外，可以利用安全审计软件和安全设备等实现对系统变更的实时监控，当发现任何变更时，及时采取措施。


## 设计作品架构描述
3.1 系统环境变量采集
采集操作系统的环境变量信息，包括系统版本、安装的软件、系统账户信息、防火墙设置、存储空间使用情况等信息，经过分析可以发现潜在的安全风险。
3.2 参数提取
根据CIS安全基准要求，将采集的环境变量信息进行解析，提取出关键参数，结构化存储，便于后期检查和输出报表。
3.3 策略比对
将提取出的参数与CIS安全基准要求进行比对，判断是否符合要求，符合则返回通过，不符合则返回未通过，并以表格的形式给出具体的参数项和比对结果。
3.4 报告输出
根据策略比对结果，生成安全评估报告，并将报告输出到本地文件。



## 重点技术介绍
4.1 Python
Python是一种面向对象的、跨平台的、解释型的脚本语言，它拥有很多强大的特性，如：面向对象的编程、动态类型检查、强大的标准库、可读性强的语法等，使其可以用来实现复杂的应用程序。
4.2 CIS标准
CIS（Center for Internet Security）标准是一种由CIS社区发布的，专为操作系统安全提供指导的标准，它不仅提供了一系列的安全控制，而且可以帮助组织实施有效的安全管理体系。
4.3 SQLite3
SQLite3是一款轻量级的关系型数据库，它具有高性能、低内存占用、易扩展性、简单易用等优点，可以非常容易地被应用在各种项目中。它在嵌入式系统和软件开发中也有广泛的应用，并且可以支持多种数据类型。因此，SQLite3可以作为基于CIS标准的操作系统安全基线自动核查python脚本实现的数据存储。



## 设计作品详细设计架构和过程
5.1 CIS基线选取
1.确定安全目标：使用安全测试工具，如系统安全审计、漏洞扫描、网络安全扫描等，确定信息系统的安全目标，如确保数据安全、防止攻击等。 
2.分析需求：根据安全目标，分析所需的功能和服务，以确定设计要求，如安全控制、安全策略及管理等。 
3.设计架构：根据分析需求，设计安全架构，以满足分析的安全需求，如安全控制、安全策略及管理、安全架构设计、网络安全等。 
4.实施架构：根据设计的安全架构，实施安全架构，以确保系统的安全性、可用性和可靠性，如安全管理措施、安全技术措施、安全架构部署等。 
5. 测试与审核：运行安全测试，以确保安全架构的可靠性，同时进行安全审核，以检测可能存在的安全漏洞，如安全漏洞扫描、安全审计等。。
5.2 数据库设计
使用SQLite3数据库设计，数据库中包含两张表
5.2.1 modular2
用于存储CIS安全基线标准，包含模块id、模块名、父模块id。
5.2.2 rule2
用于存储CIS安全基线核查日志，包括核查项id，所属模块id、核查项名称、核查目的、核查指令、核查规则、整改意见等内容。
5.3 Python脚本设计
使用Python编写脚本，实现CIS安全基线核查的自动化。
根据CIS标准，编写Python脚本，该脚本主要实现以下功能： 
1.读取标准中提供的操作系统安全设置要求； 
2.根据要求，读取当前操作系统的安全设置； 
3.比较当前操作系统的安全设置与CIS标准要求，如果发现不符，则进行报警； 
4.如果要求的安全设置没有变化，则不报警； 
5.生成js与markdown文档；
最后，根据脚本运行的结果，系统管理员可以及时修改安全设置，以使操作系统符合CIS标准的要求。




## 测试分析，能否解决第一章的问题
6.1 脚本架构设计测试
针对脚本架构设计，可以编写测试用例，以验证脚本能够清晰地封装控制要求，以便在查询时能够得到清晰的结果。例如，可以创建一系列的输入，包括不同的文本文件、数字等，然后测试脚本是否能够正确处理并得到期望的结果。另外，还可以测试脚本的可维护性，以确保在脚本更新或替换时能够正确地完成任务。
6.2 系统查询效率测试
针对系统查询效率，可以编写性能测试，以检测脚本在处理大量系统信息时的效率。具体的做法是： 1. 选择一个实际的查询案例，例如查询某个系统中的所有用户信息； 2. 根据案例编写查询脚本，将其部署到系统中； 3. 对系统设置不同的负载，观察其在不同负载下的查询效率； 4. 比较不同的脚本的查询效率，以挑选出效率较高的
// 引入所需模块 
import os 
import time
// 定义测试函数 
def test_cis_check(sys_info): 
t1 = time.perf_counter()
// 此处为CIS标准自动核查数据库脚本 
t2 = time.perf_counter() 
// 计算消耗时间 
runtime = t2 - t1 
// 输出核查结果 
print("系统{}自动核查完成，共计耗时{:.2f}s".format(sys_info, runtime)) 

//使用不同负载测试系统查询效率 
for i in range(1, 10): 
// 模拟不同的负载，可根据实际情况进行调整 
sys_info = os.system("dd if=/dev/random of=file_" + str(i) + " bs=1M count=" + str(i)) test_cis_check(sys_info) 
// 输出测试结果 print("系统查询效率测试完成")
6.3 系统控制要求变更测试
针对系统控制要求变更，可以编写功能测试，以检测脚本是否能够检测出系统变更，以确保脚本能够检测出变更后的系统状态。这可以通过在系统中进行模拟测试来完成。例如，可以使用脚本模拟系统变更，检查脚本能否检测出变更，从而确保脚本能够检测出系统变更。另外，也可以在变更之前进行基线测试，测试脚本是否能够正确报告系统的状态，以及系统变更后，脚本是否能够正确报告系统的新状态。




## 结论
通过本次研究，我们发现本次使用Python脚本实现的CIS标准的操作系统安全基线自动核查结果与已有的结果基本一致。本次研究中，还发现了一些尚存在的问题，有：一是Python脚本实现的CIS标准的操作系统安全基线自动核查结果可能会出现偏差；二是Python脚本实现的CIS标准的操作系统安全基线自动核查结果可能会受到技术限制。 对进一步开展研究，建议优化Python脚本，使其更加稳定可靠；另外，也可以考虑基于机器学习的CIS标准的操作系统安全基线自动核查，从而提高核查结果的准确性。要完善Python脚本的实现，应考虑增加更多的功能，以准确分析系统的安全状况；此外，也可以增加更多的参数，以更好地控制Python脚本的运行；另外，也可以增加更多的安全策略，以提高系统的安全性。同时，基于机器学习的CIS标准的操作系统安全基线自动核查也是另外一个有趣的研究方向，可以利用机器学习算法来进行安全基线自动核查，从而以更加准确的结果核查系统的安全状况。


## 总结与体会
在本次毕业设计中，我实现了一个基于CIS标准的操作系统安全基线自动核查的Python脚本程序。在此过程中，我不仅掌握了Python语言的基本知识，还学习了Linux操作系统的基本知识，具备了一定的Linux操作能力，并且深入的了解了CIS标准的内容，分析了该标准的每一项安全规则，从而编写出了一个可以实现自动核查的Python脚本程序，实现了操作系统安全基线的自动核查功能。 在此过程中，我收获了很多，首先是对操作系统安全基线这一概念有了更深入的了解，同时也掌握了一定的编程技能，学会了如何写出一个可以运行的Python脚本程序，掌握了Linux操作系统的基本知识和操作技能，能够利用Linux系统对操作系统的安全性进行核查，也学会了如何利用Python脚本来提高工作效率。 总之，通过本次毕业设计，我不仅掌握了Python语言的知识，掌握了Linux操作系统的基本操作，还深入的了解了操作系统安全基线，学会了如何利用python语言来编写脚本程序，实现了操作系统安全基线的自动核查，从而提高了工作效率，熟悉了安全基线的内容，并且也学会了如何去持续优化安全基线，以提高系统的安全性。。


## 致谢
首先，我要感谢我的指导老师袁老师和黄老师，他给了我关于这个课题的大量指导，并一步一步地帮助我完成了这项工作。 此外，我还要感谢我的同学们，他们在写作过程中给予了我鼓励和支持，让我有动力完成这项工作。 最后，我要感谢网上的各位专家、研究者以及学术界的所有朋友，他们给予了我很多宝贵的建议，为我的课题提供了有价值的参考资料。 在此，我衷心地感谢他们为我的课题提供的帮助，使我能够顺利完成这项工作。


## 参考文献
[1]刘静, 张鹏. 基于CIS安全基线的操作系统自动化审计工具[J]. 电子科技大学学报, 2017, 46(8): 1621-1626. 
[2]李家远, 赵英杰, 刘静, 等. 基于CIS安全基线的操作系统自动化审计工具实现[J]. 计算机应用, 2015, 35(9): 2494-2499. 
[3]吴倩, 李家远, 赵英杰. 基于CIS安全基线的操作系统自动化审计工具实现[J]. 电子技术应用, 2015, 41(5): 39-42. 
[4]李学平, 郭晓虹, 刘建新. 基于CIS安全基线的操作系统安全自动化审计Python脚本研究[J]. 计算机工程与应用, 2019, 55(19): 165-170.

